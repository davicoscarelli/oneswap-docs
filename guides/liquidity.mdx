---
title: Liquidity
description: Provide liquidity to pools and track earnings.
---

## Add liquidity

```typescript
const lp = await client.liquidity.create({
  poolId: 'Amulet-USDCx',
  amountA: '100',
  amountB: '150',
  walletAddress: 'alice::12205a8c...'
})

console.log(lp.depositAddress) // send both tokens here
console.log(lp.expiresAt)      // 30 min to deposit both
```

Both tokens need to be sent to the same `depositAddress`. Order doesn't matter.

## Track LP status

```typescript
lp.on('partial', () => console.log('One token received'))
lp.on('completed', () => console.log('LP tokens minted'))

const result = await lp.wait()
```

Or poll manually:

```typescript
const status = await client.liquidity.getStatus(lp.intentId)
```

## Status lifecycle

```
pending → partial (one token received)
        → completed (both received, LP minted)
        → expired (not completed in 30 min)
```

## View positions

```typescript
const positions = await client.positions.list('alice::12205a8c...')

for (const pos of positions.positions) {
  console.log(`${pos.poolName}: ${pos.sharePercent}% share`)
  console.log(`  ${pos.tokenA}: ${pos.valueTokenA}`)
  console.log(`  ${pos.tokenB}: ${pos.valueTokenB}`)
}
```

## Check earnings

```typescript
const earnings = await client.positions.getEarnings('alice::12205a8c...', 'Amulet-USDCx')

console.log(`APR: ${earnings.apr}%`)
console.log(`Projected daily earnings: ${earnings.estimatedDailyEarnings}`)
console.log(`LP share: ${earnings.lpSharePercent}%`)

// What you'd actually receive if you withdrew now
const { tokenA, tokenB } = earnings.withdrawable
console.log(`Withdrawable: ${tokenA.amount} ${tokenA.name}, ${tokenB.amount} ${tokenB.name}`)
```

<Note>
Earnings estimates are **projections** based on the pool's trailing 24-hour fee volume and your current LP share. They are not accrued balances. Use `withdrawable` to see the actual token amounts you would receive if you removed your liquidity now.
</Note>

## Withdraw liquidity

```typescript
// Withdraw full position
const result = await client.liquidity.withdraw({
  poolId: 'Amulet-USDCx',
  ownerParty: 'alice::12205a8c...',
  destinationParty: 'alice::12205a8c...',
})

console.log(`Withdrew ${result.lpTokensWithdrawn} LP tokens`)
console.log(`Received: ${result.returnedA} ${result.tokenA}, ${result.returnedB} ${result.tokenB}`)
```

Partial withdrawal — specify an `amount` of LP tokens:

```typescript
const result = await client.liquidity.withdraw({
  poolId: 'Amulet-USDCx',
  ownerParty: 'alice::12205a8c...',
  amount: '50',                          // withdraw 50 LP tokens (not all)
  destinationParty: 'bob::98def1...',    // send to a different party
})
```

| Param | Required | Description |
|---|---|---|
| `poolId` | yes | Pool to withdraw from |
| `ownerParty` | yes | Canton party that owns the LP tokens |
| `amount` | no | LP tokens to withdraw (defaults to full balance) |
| `destinationParty` | yes | Canton party to receive withdrawn tokens |

## Browse pools

```typescript
// list all pools
const pools = await client.pools.list()

// get details for one pool (includes addresses)
const pool = await client.pools.get('Amulet-USDCx')
console.log(pool.swapAddress, pool.lpAddress)

// get pool stats
const stats = await client.pools.getStats('Amulet-USDCx')
console.log(`TVL: ${stats.tvl}, APR: ${stats.apr}%`)
```

## List past LP intents

```typescript
const all = await client.liquidity.list()
const pending = await client.liquidity.list({ status: 'pending' })
```
